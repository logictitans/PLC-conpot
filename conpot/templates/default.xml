<conpot_template name="S7-200" description="Rough simulation of a basic Siemens S7-200 CPU with 2 slaves">
    <core>
        <datastore>
            <key_value_mappings>
                <key name="OutsideTemperatureSensor">
                    <!-- Example where we use a external API to supply realistic values to the attacker -->
                    <value type="function"
                           parameters="NewYork">conpot.emulators.sensors.outsidetemperature</value>
                </key>
                <key name="SystemDescription">
                    <value type="value">Siemens, SIMATIC, S7-200</value>
                </key>
                <key name="Uptime">
                    <value type="function">conpot.emulators.misc.uptime</value>
                </key>
                <key name="GpsPosition">
                <!-- Returns coordinates that deviates from the given coordinates -->
                    <value type="function" parameters="25.000068, -71.000012">conpot.emulators.sensors.deviatinggps</value>
                </key>
            </key_value_mappings>
        </datastore>
    </core>
    <protocols>
        <snmp>
            <config>
                <!-- Configure individual delays for SNMP commands -->
                <entity name="tarpit" command="get">0.1;0.2</entity>
                <entity name="tarpit" command="set">0.1;0.2</entity>
                <entity name="tarpit" command="next">0.0;0.1</entity>
                <entity name="tarpit" command="bulk">0.2;0.4</entity>

                <!-- Configure DoS evasion thresholds (req_per_ip/minute;req_overall/minute) -->
                <entity name="evasion" command="get">120;240</entity>
                <entity name="evasion" command="set">120;240</entity>
                <entity name="evasion" command="next">240;600</entity>
                <entity name="evasion" command="bulk">120;240</entity>
            </config>
            <mibs>
                <mib name="SNMPv2-MIB">
                    <symbol name="sysDescr">
                        <!-- Values maps to keys in the datastore -->
                        <value>SystemDescription</value>
                    </symbol>
                    <symbol name="sysUpTime">
                        <value>Uptime</value>
                    </symbol>
                    <symbol name="sysPosition">
                        <value>GpsPosition</value>
                    </symbol>
                </mib>
            </mibs>
        </snmp>
    </protocols>
</conpot_template>
